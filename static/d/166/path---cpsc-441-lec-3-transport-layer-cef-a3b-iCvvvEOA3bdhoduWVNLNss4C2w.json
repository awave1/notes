{"data":{"markdownRemark":{"html":"<p>A transport layer protocol provides for <strong>logical communication</strong>. <em>Logical communication</em> means that from an application's perpective, it is as if the hosts running the processes were directly connected; in reality, the hosts may be far away from each other, connected via numerous routers. Application processes use the logical communication provided by the transport layer to send messages to each other, without having to worry about physical infrastructure used to deliver these messages.</p>\n<p>Transport layer protocols are implemented in the end systems, but not in networks routers:</p>\n<ul>\n<li>On the <em>sending side</em>, the transport layer converts the application layer messages it receives from a sending application process into transport layer <strong>segments</strong>.</li>\n<li>On the <em>receiving side</em>, the network layer extracts the transport layer segment from the datagram and passes the segment up to the transport layer. The transport layer then processes the received segment and sends it to the receiving application.</li>\n</ul>\n<p>There are more than one transport protocol available to applications. The ones that are used in the Internet are TCP and UDP.</p>\n<p><strong>Relationship between transport and network layers</strong>:</p>\n<ul>\n<li><em>Network layer</em>: logical communication between hosts.</li>\n<li><em>Transport layer</em>: logical communication between processes. It relies on and enhances network layer services.</li>\n</ul>\n<h2>Overview of the Transport Layer in the Internet</h2>\n<p>The Internet makes two distinct transport layer protocols available to the application level. One of those is <strong>UDP</strong> (User Datagram Protocol), which provides unreliable, connectionless service to the invoking application. The second one is <strong>TCP</strong> (Transmission Control Protocol), which provides a reliable, connection oriented service to the invoking application. When designing a network application, an application developer must specify one of these two protocols.</p>\n<p>The Internet’s network-layer protocol has a name—IP, for Internet Protocol. IP provides logical communication between hosts. The IP service model is a <strong>best-effort delivery service</strong>. This means that IP makes its “best effort” to deliver segments between communicating hosts, <em>but it makes no guarantees</em>. In particular, it doesn't guarantee segment delivery, it doesn't guarantee orderly delivery of segments, and it doesn't guarantee the integrity of the data in the segments. For these reasons the IP is said to be an <strong>unreliable service</strong>.</p>\n<p>The most fundamental responsibility of UDP and TCP is to extend IP’s <em>delivery service</em> between two end systems to a delivery service between two processes running on the end systems. Extending host-to-host delivery to process-to-process delivery is called <strong>transport-layer multiplexing</strong> and <strong>demultiplexing</strong>.</p>\n<h2>Multiplexing and demultiplexing</h2>\n<p>At the destination host, the transport layer has the responsibility of delivering the data in the received segments. Each received transport-layer segment has a set of fields in the segment to determine appropriate socket for each segment. At the receiving end, the transport layer examines these fields to identify receiving sockets and direct segments to those sockets.</p>\n<p><strong>Demultiplexing</strong> is the process of delivering the data in a transport-layer segment to the correct socket. The job of gathering data chunks at the source host from different sockets, encapsulating each data chunk with header information, that later will be used in <em>demultiplexing</em>, to create segments, and passing the segments to the network layers is called <strong>multiplexing</strong>.</p>\n<p>In a host, transport-layer multiplexing requires:</p>\n<ol>\n<li>that sockets have unique identifiers</li>\n<li>that each segment have special fields taht indicate the socket to which the segment is to be delivered</li>\n</ol>\n<p>Therefore, a <strong>source port number</strong> and <strong>destination port number</strong> is specified in a segment. Each port number is a 16-bit number. The port numbers ranging from 0 to 1023 are reserved and called <strong>well-known port numbers</strong>.</p>\n<p>Each socket in the host could be assigned a port number, and when a segment arrives at the host, the transport layer examines the destination port number in the segment and directs the segment to the corresponding socket. The segment's data then passes through the socket into the attacked process.</p>\n<p>Mux/demux communication:</p>\n<ul>\n<li>one-to-many communication, with UDP server</li>\n<li>\n<p>one-to-many communication, TCP communication:</p>\n<ul>\n<li>TCP: one socket to one client</li>\n</ul>\n</li>\n</ul>\n<hr>\n<ul>\n<li><strong>Multiplexing (mux) at sender</strong>: handle data from multiple sockets, add transport header (later used for demultiplexing).</li>\n<li><strong>Demultiplexing (demux) at receiver</strong>: use header info to deliver received segments to correct sockets.</li>\n</ul>\n<p><strong>How demultiplexing works?</strong></p>\n<p>Host receives IP datagrams:</p>\n<ul>\n<li>each datagram has source IP address, destination IP address</li>\n<li>each datagram carries one transport-layer segment</li>\n<li>each segment has source port and destination port</li>\n</ul>\n<p>Host uses <strong>IP addresses &#x26; port numbers</strong> to direct segment to appropriate socket.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/b50fd78c9047b38708ee4edba075296f/dffc8/lec3-tcp-udp-segment-format.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 572px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 113.98601398601397%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABYlAAAWJQFJUiTwAAADX0lEQVQ4y61V21IaWRTld/MJeUxlCElqZvIJsaJ58CFT5SVaKpII0cKEbrpFQC7dzR1EUECRO2v2Ok0TzcxD5nKqVu2zz9nssy9rN77hcAhgLJgKJgtQl92kj2rVQbtdh2WlMZsN4a7xA1sPI3XjK5dr2NyKYWfHFBjY2TWxva3j81EOh6ELvF3Zx4c/ovj9zToOgil8+pTB9sf40pb4KPrGZgy92wl8llVG4NWR4IsggkAgjMDLCPyBIzx/FsTLF0d4+nQbr15/gf+XEPyiv/B/RkB0Sv/zEH77NYInTzblcRO+aq0KWEkgYwIpDajkgXIOiEWAVhm4KqHXrbuZ5hPA1zBQs4C0Dtjyu2JGLnqwSy2srerwZTIZZHQDNmEmBOewYnFYugknm0fRcmDKuWMX4Jwl1Z0tMv9Ng5NMw05n0WxUpQxf8e6dOCyVSuhLYybzOUbTKYbjMYaTicJI9gO5Y+OUFH08m7k2C9vByG3GaTSP1bW4pFytYjqd4t+u+WyuZDxewtqaAV+lUsF47NKEkezv7yMUCuH09BQsRyQSwfHxMba2tpBIJBCLxbC7u6v0YrG4dKxpRXEoEdZqNczn8wXvJri4uBDOWbBtG71eTzlNpVI4OzvD5eUlWq2W0olms7l0aBgVN0LHcXB9fY3b21sFOmXEI6nN/f292vOMZRkMBgrUCe47na4QfiSZpLG6KhHmcjkwbb7WaDRQr9eXoM4MuPfkQxt335BAbnBwoItD3U35/1imWf1rU2ZCCdaT6THidrut6nl1dQXSi4+zrrTx4DFE0wpuU+iQ9VAUWDSHD6yvr6tOBoNBhMPhZWfZDM+WYBBcul78e4ceuFgj0ufk5ETtl9xb3HtZ/bTDfr+v6EKnTNuj1j+K0DMgHzc2NqR7B4rce3t7Km1292G9f9ohI8pmsygUCipdTgWbcnd39yjC6fS7w/fvjceT8l+WrpexsiI85Ih1Oh1VL29aPJAiP+JHm263J1GOhDY5KUkKPo4do+SMknc3NzePJNHtdtV48uGH5zyjTjSbl8qxzwv5/Pwc0WhUcY6dPTw8VF8WzjplMpmUT1RcJsJU94ZhqN9omqbO+aj6k/KawAjZhHQ6rSSNGDkd8pOm67pyxE8Yy8QJoh112jJ9rj8Bkr6aOZP24J0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"TCP/UDP segment format\"\n        title=\"\"\n        src=\"/notes/static/b50fd78c9047b38708ee4edba075296f/dffc8/lec3-tcp-udp-segment-format.png\"\n        srcset=\"/notes/static/b50fd78c9047b38708ee4edba075296f/4979b/lec3-tcp-udp-segment-format.png 148w,\n/notes/static/b50fd78c9047b38708ee4edba075296f/25fcd/lec3-tcp-udp-segment-format.png 295w,\n/notes/static/b50fd78c9047b38708ee4edba075296f/dffc8/lec3-tcp-udp-segment-format.png 572w\"\n        sizes=\"(max-width: 572px) 100vw, 572px\"\n      />\n  </span>\n  </a></p>\n<h3>Connectionless multiplexing and demultiplexing</h3>\n<blockquote>\n<p>Connectionless multiplexing and demultiplexing is done using UDP protocol</p>\n</blockquote>\n<p>Suppose a process in Host A, with UDP port 19157, wants to send a chunk of application data to a process with UDP port 46428 in Host B. The transport layer in Host A creates a transport-layer segment that includes the application data, the source port number, the destination port number, and two other values. The transport layer then passes the resulting segment to the network layer. The network layer encapsulates the segment in an IP datagram and makes a best effort attempt to deliver the segment to the receiving host. If the segment arrives at the receiving Host B, the trasnport layer at the receiving host examines the destination port number and deliveres the segment to its socket identified by destination port. As UDP segments arrive from the network, Host B directs, or <em>demultiplexes</em>, each segment to the appropriate socket by examining the segment's destination port number.</p>\n<p>The source port number serves as part of a \"return address\" - when B wants to send a segment back to A, the destination port in the B-to-A segment will take its value from the source port value of the A-to-B segment.</p>\n<h3>Connection-oriented multiplexing and demultiplexing</h3>\n<blockquote>\n<p>Connection-oriented multiplexing and demultiplexing is done using TCP protocol</p>\n</blockquote>\n<p>A TCP socket is identified by a four-tuple: (source IP, source port, destination IP, destination port). Thus when a TCP segment arrives from the network to a host, the host uses all four values to direct, or <em>demultiplex</em>, the segment to the appropriate socket. In contrast with UDP, two arriving TCP segments with different IP addresses or source ports will be directed to two different sockets.</p>\n<p>Server host may support many simultaneous TCP sockets since with each socket attached to a process and with each socket identified by its own four-tuple. When a TCP segment arrives at the host, all four fileds are used to direct the segment to appropriate socket.</p>\n<h2>Connectionless transport: UDP</h2>\n<p>UDP does as little as a transport protocol can do. Aside from multiplexing/demultiplexing function and some light error checking it adds nothing to IP. UDP takes messages from application process, attaches source and destination port number fields for multiplexing/demultiplexing service and two other small fields, and passes the resulting segment to the network layer. The network layer then encapsulates the transport layer segment into an IP datagram and then makes the <strong>best effort</strong> attempt to deliver the segment to the receiving host. If the segment arrives at the receiving host, UDP uses the destination port to deliver the segment's data to the correct application process. <em>Note</em> since that there is no handshaking between sending and receiving transport layer entities, UDP is said to be <strong>connectionless</strong>.</p>\n<p>For some application UDP is better suited for following reasons:</p>\n<ul>\n<li><em>Finer application-level control over what data is sent and when</em>. As soon as an application process passes data to UDP, UDP will package the data inside a UDP segment and immediately pass the segment to network layer. Useful when building real-time applications, since we do not want delay segment transition and can tolerate some data loss. TCP will not be good fit due to its congestion control and packet delivery guarantee (p.199).</li>\n<li><em>UDP doesn't establish connection, therefore less or no delay</em>. In case with TCP there's a three-way handshake before the data is transferred. UDP simply sends the data. Thus UDP does not introduce any delay to establish a connection. (hence why DNS is using UDP rather than TCP - DNS would be much slower if it ran over TCP).</li>\n<li><em>No connection state</em>. TCP maintains connection state in the end systems. State information is needed for TCP congestion control. UDP on the other hand does not track any of parameters.</li>\n<li><em>Smaller header size</em>. TCP segment has <mark><strong>20 bytes</strong></mark> of overhead, UDP has only <mark><strong>8 bytes</strong></mark></li>\n</ul>\n<h3>UDP Segement Structure</h3>\n<p>The UDP header has only four fields, each consulting of 2 byes:</p>\n<ul>\n<li>Source port number</li>\n<li>Destination port number</li>\n<li>Length field, specifies number of bytes in UDP segment (header + data)</li>\n<li>Checksum, used by the receiving host for error checking</li>\n</ul>\n<h4>UDP Checksum</h4>\n<p>The goal of checksum is to detect errors in transmitted sender. The checksum is used to determine whether bits within the UDP segment have been altered. UDP at the sender performs <strong>1s complement of the sum of all the 16bit words in a segment</strong> with any overflow encountered during the sum being wrapped around. The result is put in a checsum field.</p>\n<p>For example, calculation of checksum at <em>sender</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">     1 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0\n+    1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1\n     - - - - - - - - - - - - - - - -\n   1 1 0 1 1 1 0 1 1 1 0 1 1 1 0 1 1   // wrap around extra 1\n+                                  1\n     - - - - - - - - - - - - - - - -\nsum  1 0 1 1 1 0 1 1 1 0 1 1 1 1 0 0\ncsum 0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 1</code></pre></div>\n<p>UDP provides a checksum because there is no guarantee that all the links between source and destination provide error checking.</p>\n<p><strong>Sender</strong>:</p>\n<ul>\n<li>Treat segment contents, including header fields, as sequence of 16-bit integers</li>\n<li>Checksum: addition (one's complement sum) of segment contents</li>\n<li>Sender puts checksum value into UDP checksum field</li>\n</ul>\n<p><strong>Receiver</strong>:</p>\n<p>At the receiver, 16bit words are added, including the checksum. If no errors are introduced into the packet, then the sum at the receiver will be all 1's. If one of the bits is a 0, then we know that there is an error</p>\n<p>Checking checksum at the receiver:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">     1 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0\n+    1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1\n     0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 1\n     - - - - - - - - - - - - - - - -\n   1 1 0 1 1 1 0 1 1 1 0 1 1 1 0 1 1   // wrap around extra 1\n+                                  1\n     - - - - - - - - - - - - - - - -\n     1 0 1 1 1 0 1 1 1 0 1 1 1 1 0 0\n+    0 1 0 0 0 1 0 0 0 1 0 0 0 0 1 1\n     - - - - - - - - - - - - - - - -\n     1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</code></pre></div>\n<h2>Principles of reliable data transfer</h2>\n<p>It is the responsibility of <strong>reliable data transfer protocol (rdt)</strong> to implement service abstraction.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/4ec8b7e10730046f530e5bc1b5ac233f/2b086/lec3-rdt-principle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 48.15864022662889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABxUlEQVQoz41SaW+bQBDl//+NfqkUya4qJa4Uxwm+oBRIAthRfNWAzRqcJo5jTgOvs1iO0qpNO9JoZndn37w5hLIs8S/5n5ijCA/rdeVEcYKQNM8LpCn3Q8RkOdjvij/cHVVwXBf7PEdTbOPkrAnL8XFt6Phy2URL7SDJ9weW7zB+exJin6HMMigX55Abp0h3O4y1bxA/1eDaNgpiWv4IUDwEyPwlyu1T9TENfGRBgPLxsdIijpEXBQQOwMXQNXzttDE0bmFoKlSpjzjcYTJ38PlSRqOr4UOtgXpLRpQkOKl/RP20Bknro6/1YN5bSKllwuz7rALMiGVEWRIKTtIUMVkutrvAebsLSb+FbloQh3O4LMCNeYOeIkOh5LKpQZmZh5I3m6e/TownmY1GUDoiruU+5KsWup0uNs/PuGicQRKvYKgqdAKe2NMD4HsrwIf1sg6Q+Cuw+zvcEehQ6oEtFhiSP1IVOAMLEfMQUh+rHr5+3u8rRimVm2VpZQsCPMpmu4U1GGA0HmNgWZhMpzAJjK1Wv+5hTH0LwxCMMSyXCzg0WZdWybbnCGiKCb1vqUTmeRTjIfB9eN4SS2LJz9zyd44TRRF+AtGM7nFdC8tnAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Principle of RDT\"\n        title=\"\"\n        src=\"/notes/static/4ec8b7e10730046f530e5bc1b5ac233f/fb8a0/lec3-rdt-principle.png\"\n        srcset=\"/notes/static/4ec8b7e10730046f530e5bc1b5ac233f/1a291/lec3-rdt-principle.png 148w,\n/notes/static/4ec8b7e10730046f530e5bc1b5ac233f/2bc4a/lec3-rdt-principle.png 295w,\n/notes/static/4ec8b7e10730046f530e5bc1b5ac233f/fb8a0/lec3-rdt-principle.png 590w,\n/notes/static/4ec8b7e10730046f530e5bc1b5ac233f/526de/lec3-rdt-principle.png 885w,\n/notes/static/4ec8b7e10730046f530e5bc1b5ac233f/fa2eb/lec3-rdt-principle.png 1180w,\n/notes/static/4ec8b7e10730046f530e5bc1b5ac233f/2b086/lec3-rdt-principle.png 1412w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<ul>\n<li><code class=\"language-text\">rdt_send()</code>: Called from layer above (application layer). Passed data to deliver to receiver upper layer.</li>\n<li><code class=\"language-text\">deliver_data()</code>: Called by <strong>rdt</strong> to deliver data to upper layer.</li>\n<li><code class=\"language-text\">udt_send()</code>: Called by rdt to transfer packet over unreliable channel to receiver.</li>\n<li><code class=\"language-text\">rdt_rcv()</code>: Called when packet arrives from the receiving side of the channel.</li>\n</ul>\n<h3>RDT 1.0: reliable transfer over a reliable channel</h3>\n<p>The sending side of rdt simply accepts data from upper layer via <code class=\"language-text\">rdt_send(data)</code>, creates a packet via <code class=\"language-text\">make_pkt(data)</code> and sends the packet into the channel, using <code class=\"language-text\">udt_send(packet)</code>. On the receiving side, rdt receives a packet from the underlying channel via <code class=\"language-text\">rdt_rcv(packet)</code>, extracts the packet and delivers the data from the packet to the upper layer.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/78bf482fc60016b5caa676218e3e3e4a/61e7c/lec3-rdt1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 26.1455525606469%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA40lEQVQY001Q24qDQAz1/z/LF58U2aqw1boqqChFC1pvM+PZJHSkgTDJnAtJHGMMpmnCMAyY5xlaaxzHgXVdoZSCjfM8sW0bxnGU3Pf94nJtw2FiFEXwPA9lWSLPc6RpijiO0TSNCJZlEXLf93BdVzDm+r6PIAhEW9e1GDtM7LpOTPitqgo3EtypD8MQWZahbVsxZGPui6JA/3wifTzwR3WSJKK/DHl0JmtaX/NErxfelPzHG9iVOXhiRWlofU244Zp0FndsYUPTfdafG46ivIxOEnyb0gRYf+9Y6FSKbv8BBf8HaZp8yAPYDh4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"RDT1.0 FSM\"\n        title=\"\"\n        src=\"/notes/static/78bf482fc60016b5caa676218e3e3e4a/fb8a0/lec3-rdt1.png\"\n        srcset=\"/notes/static/78bf482fc60016b5caa676218e3e3e4a/1a291/lec3-rdt1.png 148w,\n/notes/static/78bf482fc60016b5caa676218e3e3e4a/2bc4a/lec3-rdt1.png 295w,\n/notes/static/78bf482fc60016b5caa676218e3e3e4a/fb8a0/lec3-rdt1.png 590w,\n/notes/static/78bf482fc60016b5caa676218e3e3e4a/526de/lec3-rdt1.png 885w,\n/notes/static/78bf482fc60016b5caa676218e3e3e4a/fa2eb/lec3-rdt1.png 1180w,\n/notes/static/78bf482fc60016b5caa676218e3e3e4a/61e7c/lec3-rdt1.png 1484w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>In this protocol there is no difference between a unit o data and a packet. All packet flow is from the sender to receiver; with a reliable channel, there is no need for receiver to provide feedback to the sender since nothing can go wrong.</p>\n<h3>RDT 2.0: channel with bit errors</h3>\n<ul>\n<li>In real life there are probabilities that checksum will get corrupted, but for this example, checksum is perfect.</li>\n<li>\n<p>Add a sequence number to packets to deal with packet duplicates</p>\n<ul>\n<li>checksum will detect sequence number corruption</li>\n<li>only two sequence numbers are needed (0 &#x26; 1)</li>\n</ul>\n</li>\n</ul>\n<h4>Flaw</h4>\n<p>What happens if ACK/NAK corrupted?</p>\n<ul>\n<li>sender doesn't know what happened at the receiver</li>\n<li>can't just retransmit possible duplicate</li>\n</ul>\n<p>To handle duplicate packets:</p>\n<ul>\n<li>sender retransmits current packet if ACK/NAK corrupted</li>\n<li>sender adds <strong>sequence number</strong> to each packet</li>\n<li>receiver discards (doesn't deliver up) duplicate packet</li>\n</ul>\n<h3>RDT 2.1</h3>\n<p>Protocol <code class=\"language-text\">rdt2.1</code> uses both positive and negative acknowledgments from the receiver to sender.</p>\n<ul>\n<li>When an out-of-order packet is received, the receiver sends an <code class=\"language-text\">ack</code> for the packet it has received</li>\n<li>When a corrupted packet is received, the receiver sends a <code class=\"language-text\">nak</code></li>\n</ul>\n<p>The protocol uses 1-bit sequence number, it allows the receiver whether the sender is resending the previously transmitted packed (the sequence number of the received packet has the same sequence number as the recently received packet) or a new packet (the sequence number changes).</p>\n<h3>RDT 2.2: a NAK-free protocol</h3>\n<p>Same functionality as RDT2.1, using <code class=\"language-text\">ack</code> only. Instead of <code class=\"language-text\">nak</code>, receiver sends <code class=\"language-text\">ack</code> for last packet received. Receiver must <em>explicitly</em> include sequence number of packet being <code class=\"language-text\">acked</code>. Duplicate <code class=\"language-text\">ack</code> at sender results in same action as <code class=\"language-text\">nak</code>: <em>retransmit current packet</em>.</p>\n<p><code class=\"language-text\">nak</code> behavior is implemented through <em>duplicate <code class=\"language-text\">ack</code></em>.</p>\n<h3>RDT 3.0: Channels with errors <em>and</em> loss</h3>\n<p>New assumption: underlying channel can also lose packets (data, <code class=\"language-text\">acks</code>). Checksum, sequence number, <code class=\"language-text\">acks</code>, retransmissions will help, but not by much. Approach: Sender will have a timer; sender waits \"reasonable\" amount of time for <code class=\"language-text\">ack</code>. The time is average round-trip time for packet to get to the server and back. It will retransmit if no <code class=\"language-text\">ack</code> received in this time. If packet (or <code class=\"language-text\">ack</code>) just delayed and not lost: retransmission will be duplicate, but sequence numbers already handles this. This approach requires countdown timer.</p>\n<p><img src=\"lec3-rdt3.png\" alt=\"rdt3\"></p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/5917e/lec3-rdt3-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 59.07172995780591%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACRElEQVQoz11S2XKbQBDk///JT3ZVEj/EhywVAmxuEAssy3KfndlVZDuZKkpod+jp6W4DVE2zohIzvte4TMjbHHKQwH49K8oGP34GiJMa275jXjZ9nrQpztzCsA4wxnHE2zGkJ8I8r2jbRTdN+4ikS1DPUv9XmGVZIM8vRKBBUUxwPQkhe/CCIwoijMMIYxgGAqkxjT36foXtFfASjoxxWKaFNE4/Wfd9jyxjBNgiqRks5iCvK2KcwLYt8KqCMU00yXVhO3QpS5xTF2VXQTQ1NcbEKMe2XVeL4hin4xH2uwM3KuH5koYsEELgcrnoPqOnlYMggOd5SFMO8yODT78sr+A4Nhhj15WXBTsNV9V1HaZpQDM3iEpG3/o4nU4a2JiI5q2GskQXnZB1BapaII4i5H8BqzSF8/CAJQzB/QgJL/BR+HSz/WOm8XZ3B/b7CfnrASwr0ebT5+W+71/DSGv3/R3np2di5MDPChrYQ9azluxwOKBSGgpyjBMzWdcYpw12dIGXFnA+Ajzc3+tGzrkG9X0fvx4fYRIwExIud3Gpc5wtC68vL1o2HRvTNGHR4UUUONFHomvQ9i0xZhSPAsq4dV01k2dimNL6zdBTInL4gdR3KgF6ZfWihC+VfuSY6SeaYZwyYveqQVQpB2/PRKEXY4VAUMgpmyHpeiT3tSnfBRVDBdbT9EkSeKdXVU03Lbd9w77tGrDuawzzoCOvgq70U+4bt2a1ekIBVUGWQuL/UmvHlEOlUxiEZEiMKIw0u2vkUiwUrT/0cYx1SFqbLAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"rdt3\"\n        title=\"\"\n        src=\"/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/fb8a0/lec3-rdt3-1.png\"\n        srcset=\"/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/1a291/lec3-rdt3-1.png 148w,\n/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/2bc4a/lec3-rdt3-1.png 295w,\n/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/fb8a0/lec3-rdt3-1.png 590w,\n/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/5917e/lec3-rdt3-1.png 711w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p><strong>Performance</strong></p>\n<p><strong>Throughput</strong> - amount of data transmitted in 1 round / duration of 1 round = <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>L</mi><mi mathvariant=\"normal\">/</mi><mo>(</mo><mi>L</mi><mi mathvariant=\"normal\">/</mi><mi>R</mi><mo>+</mo><mi>R</mi><mi>T</mi><mi>T</mi><mo>)</mo></mrow><annotation encoding=\"application/x-tex\">L/(L/R + RTT)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">L</span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">L</span><span class=\"mord\">/</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mclose\">)</span></span></span></span> (more important to know than <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>U</mi><mrow><mi>s</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{sender}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">s</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">d</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>)</p>\n<p>RDT 3.0 is correct, but performance is bad. e.g. 1 Gbps link, 15 ms prop. delay, 8000 bit packet:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><mo>=</mo><mfrac><mi>L</mi><mi>R</mi></mfrac><mo>=</mo><mfrac><mrow><mn>8000</mn><mtext>bits</mtext></mrow><mrow><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup><mtext>bits/s</mtext></mrow></mfrac><mo>=</mo><mn>8</mn><mo>⋅</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>6</mn></mrow></msup><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">D_{trans} = \\frac{L}{R} = \\frac{8000 \\text{bits}}{10^9 \\text{bits/s}} = 8 \\cdot 10^{-6} s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">t</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault mtight\">a</span><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.04633em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.36033em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.30744em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">9</span></span></span></span></span></span></span></span><span class=\"mord text\"><span class=\"mord\">bits/s</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord text\"><span class=\"mord\">bits</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">8</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.864108em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.864108em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span><span class=\"mord mathdefault\">s</span></span></span></span></span>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>U</mi><mrow><mi>s</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{sender}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">s</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">d</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>: <strong>Utilization</strong> - fraction of time sender busy sending:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msub><mi>U</mi><mrow><mi>s</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><mrow><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mn>0.008</mn><mn>30.008</mn></mfrac><mo>=</mo><mn>0.00027</mn></mrow><annotation encoding=\"application/x-tex\">U_{sender} = \\frac{D_{trans}}{RTT + D_{trans}} = \\frac{0.008}{30.008} = 0.00027</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">s</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">d</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.19633em;vertical-align:-0.8360000000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.36033em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">t</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault mtight\">a</span><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">t</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault mtight\">a</span><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.00744em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">8</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">8</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">2</span><span class=\"mord\">7</span></span></span></span></span>\n<p>And throughput:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>T</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo>=</mo><mfrac><mn>8000</mn><mrow><msub><mi>D</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi></mrow></msub><mo>+</mo><mn>30</mn><mo>⋅</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow></mfrac><mo>=</mo><mn>33</mn><mi>k</mi><mi>B</mi><mo>(</mo><mi>y</mi><mi>e</mi><mi>s</mi><mo>)</mo><mi mathvariant=\"normal\">/</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">Tput = \\frac{8000}{D_{trans} + 30 \\cdot 10^{-3}} = 33 kB(yes)/s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\">p</span><span class=\"mord mathdefault\">u</span><span class=\"mord mathdefault\">t</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574400000000002em;vertical-align:-0.8360000000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.3139999999999996em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">t</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathdefault mtight\">a</span><span class=\"mord mathdefault mtight\">n</span><span class=\"mord mathdefault mtight\">s</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8360000000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mord\">3</span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">s</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathdefault\">s</span></span></span></span></span>\n<p>If <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>R</mi><mi>T</mi><mi>T</mi><mo>=</mo><mn>30</mn><mi>m</mi><mi>s</mi><mi>e</mi><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">RTT = 30msec</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">3</span><span class=\"mord\">0</span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">c</span></span></span></span>, 1 KB packet every 30 msec: <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>33</mn><mi>k</mi><mi>B</mi><mi mathvariant=\"normal\">/</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">33 kB/s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mord\">3</span><span class=\"mord mathdefault\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord\">/</span><span class=\"mord mathdefault\">s</span></span></span></span> throughput over 1Gbps link.</p>\n<p><strong>rdt3: stop-and-wait operation</strong></p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/5917e/lec3-rtd3-stop-and-wait.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 59.07172995780591%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACRElEQVQoz11S2XKbQBDk///JT3ZVEj/EhywVAmxuEAssy3KfndlVZDuZKkpod+jp6W4DVE2zohIzvte4TMjbHHKQwH49K8oGP34GiJMa275jXjZ9nrQpztzCsA4wxnHE2zGkJ8I8r2jbRTdN+4ikS1DPUv9XmGVZIM8vRKBBUUxwPQkhe/CCIwoijMMIYxgGAqkxjT36foXtFfASjoxxWKaFNE4/Wfd9jyxjBNgiqRks5iCvK2KcwLYt8KqCMU00yXVhO3QpS5xTF2VXQTQ1NcbEKMe2XVeL4hin4xH2uwM3KuH5koYsEELgcrnoPqOnlYMggOd5SFMO8yODT78sr+A4Nhhj15WXBTsNV9V1HaZpQDM3iEpG3/o4nU4a2JiI5q2GskQXnZB1BapaII4i5H8BqzSF8/CAJQzB/QgJL/BR+HSz/WOm8XZ3B/b7CfnrASwr0ebT5+W+71/DSGv3/R3np2di5MDPChrYQ9azluxwOKBSGgpyjBMzWdcYpw12dIGXFnA+Ajzc3+tGzrkG9X0fvx4fYRIwExIud3Gpc5wtC68vL1o2HRvTNGHR4UUUONFHomvQ9i0xZhSPAsq4dV01k2dimNL6zdBTInL4gdR3KgF6ZfWihC+VfuSY6SeaYZwyYveqQVQpB2/PRKEXY4VAUMgpmyHpeiT3tSnfBRVDBdbT9EkSeKdXVU03Lbd9w77tGrDuawzzoCOvgq70U+4bt2a1ekIBVUGWQuL/UmvHlEOlUxiEZEiMKIw0u2vkUiwUrT/0cYx1SFqbLAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"rdt3 stop and wait\"\n        title=\"\"\n        src=\"/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/fb8a0/lec3-rtd3-stop-and-wait.png\"\n        srcset=\"/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/1a291/lec3-rtd3-stop-and-wait.png 148w,\n/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/2bc4a/lec3-rtd3-stop-and-wait.png 295w,\n/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/fb8a0/lec3-rtd3-stop-and-wait.png 590w,\n/notes/static/c82ff87c0fa7fe998a43f9ed26f9b892/5917e/lec3-rtd3-stop-and-wait.png 711w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h3>Pipelined protocols</h3>\n<p><strong>Pipelining</strong>: sender allows multiple \"in-flight\", yer ro be acknowledged packets.</p>\n<p><strong>Go-back-N</strong> (easier to implement for both sender and receiver)</p>\n<p>In Go-back-N protocol, the sender is allowed to transmit multiple packets, without waiting for acknowledgement, but is constrained to have no more than some maximum number <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span></span></span></span> of unacknowledged packets in the pipeline.</p>\n<ul>\n<li>Sender can have up to <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span></span></span></span> unacked packets in pipeline</li>\n<li>\n<p>receiver only sends <strong>cumulative ack</strong></p>\n<ul>\n<li>doesn't ack packet if there's a gap</li>\n</ul>\n</li>\n<li>\n<p>Sender has timer for oldest unacked packet</p>\n<ul>\n<li>when timer expires, retransmit <em>all</em> unacked packets</li>\n</ul>\n</li>\n</ul>\n<p>GBN sends <code class=\"language-text\">ack</code> only for the next expected sequence number. Don't buffer out of order packets, just re-<code class=\"language-text\">ack</code> packet with next expected sequence number.</p>\n<p><strong>Selective Repeat</strong></p>\n<ul>\n<li>Receiver individually acknowledges all correctly received packets</li>\n<li>Sender can have up to <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span></span></span></span> unacked packets in pipeline</li>\n<li>Receiver sends <strong>individual ack</strong> for each packet</li>\n<li>\n<p>Sender maintains timer for each unacked packet</p>\n<ul>\n<li>when timer expires, retransmit only that unacked packet</li>\n</ul>\n</li>\n<li>\n<p>Sender only resends packets for which <code class=\"language-text\">ack</code> not received</p>\n<ul>\n<li>sender starts timer for each <code class=\"language-text\">unacked</code> packett</li>\n</ul>\n</li>\n<li>\n<p>Sender window:</p>\n<ul>\n<li>N consecutive seq. numbers</li>\n<li>Limits seq. numbers of send, unacked point</li>\n</ul>\n</li>\n</ul>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/5ef4f596515d52dc67992b0013d4a19f/2fbd1/lec3-stop-n-wait.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 56.24178712220762%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABdElEQVQoz31SXU/CQBDs//8dPpjwosZHEyQg7wYtBgwhUr5KoS2lH9e77bjbQhVSuGR618vuzuzcWkVRoAm77RZxHENWfbfbIQiCs7vLZeHKenx6xmg0Ls/amHLvvfXR6XRvF1RKlcxhGML3/VpVu9vH4OOzijoWHNhfeHk9L3gJK9pHsG0b3+MxJpMJPM+DFpIoRmt6QM/N4KUaIC5aGKg8b+yoLphzgPglCkP2R2sNIoLKMiyzAu2Nwb2T42Gh8R4YpCpHlqZIGRKTMfJ/JI0eSnAURfW/YauGEaG1yDHb7bGaO1iv15g7DhyG67oI2C7JsUSNqDLskzAJxNdEVBiCpwjrjBBq4r6ojJMcwekse9kZ71aSJJjNZlgtl+VICCJ5oDjF3TTB0Ffsm2b7mPBIfGtZYiSZivHcZILLyn4OBF8VyKky3hzjrr7yNaZq9oo6mfhI/DkpbJrBUqF45m022DBkZKR1saEsQsL6l1zd0c2Cv8nIV/ppDU5fAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Stop and wait\"\n        title=\"\"\n        src=\"/notes/static/5ef4f596515d52dc67992b0013d4a19f/fb8a0/lec3-stop-n-wait.png\"\n        srcset=\"/notes/static/5ef4f596515d52dc67992b0013d4a19f/1a291/lec3-stop-n-wait.png 148w,\n/notes/static/5ef4f596515d52dc67992b0013d4a19f/2bc4a/lec3-stop-n-wait.png 295w,\n/notes/static/5ef4f596515d52dc67992b0013d4a19f/fb8a0/lec3-stop-n-wait.png 590w,\n/notes/static/5ef4f596515d52dc67992b0013d4a19f/2fbd1/lec3-stop-n-wait.png 761w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/707c4511e41b24266a646834cb289d36/45fcc/lec3-pipelined.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 57.65171503957783%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABxElEQVQoz5VT3WrUQBTOO/oGPoAPID6Bl4ogFrzwrpReeOWdouJNoVika2lMsrvJbnazcZNMfmYyf/mcSZpQli7FA4ecE775zr/TdR3uq5XFfIEkSXpba91/8yyHe+tCStn7I/ZQnPvOCDo9O8fnL197W6qBcLPd4vWbt6iqesI+ROr8TVNkWYb9fo+6HsC3XoCf1zd3kIGwoQw/Li6RF2T4e1DZqM7v2QzeHw+B7yM15IJzkIbinU9xFjK4pQC3ZXbK5oXHxLHZEUJQliWEEH2UyhC+cimeXjI8u2J46bb4lEjENUdlsEVR9GrfFHmOtm2nNjiHETgXaKoKRCj8IhoflhzPrxmeXFCchxRkt8U63mC9WhtdYRPHSHc7JKbHTdPA4aZEm5mN0rIW1mc2opZgZsJLqvA9k3gfcXxLKNL1CitDFi5DzOdzYxs/ihAEwUAYhSFiE4WMZZACpG5wEjT4GLe4KgS2zJCbPmoljw5jGspDjaVc4sWM4sTnWFQaXA3DUEod3b9pKCOzXWCro72oJG6IQlQrlEJD6m4i/O8M++vQato3pS0Y/ZWMGR69FN/zENmm+kG/3CNY35EcXtJjhP8AKt+cXOggpAEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Pipelined\"\n        title=\"\"\n        src=\"/notes/static/707c4511e41b24266a646834cb289d36/fb8a0/lec3-pipelined.png\"\n        srcset=\"/notes/static/707c4511e41b24266a646834cb289d36/1a291/lec3-pipelined.png 148w,\n/notes/static/707c4511e41b24266a646834cb289d36/2bc4a/lec3-pipelined.png 295w,\n/notes/static/707c4511e41b24266a646834cb289d36/fb8a0/lec3-pipelined.png 590w,\n/notes/static/707c4511e41b24266a646834cb289d36/45fcc/lec3-pipelined.png 758w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h2>Connection-oriented transport: TCP</h2>\n<p>TCP is said to be <strong>connection-oriented</strong> because before processes begin communicating with each other, they establish connection through <strong>three way handshake</strong>. TCP provides reliable, in-order byte stream connection. It is a pipelined protocol with dynamic window size.</p>\n<p>TCP connection provides a <strong>full duplex service</strong>: bi-directional data flow. The maximum amount of data that can be grabbed and placed in a segment is limited by the <strong>maximum segment size</strong>.</p>\n<h3>Segment structure</h3>\n<p>TCP pairs each chunk of client data with TCP header, forming <strong>TCP segments</strong>.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/215d6b5291f029888f756bfc9b0c2851/b91be/lec3-tcp-segment-struct.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 93.02884615384615%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACpUlEQVQ4y41TiVLiUBDk/79if2Etdz0QWSUHkBBEEREIIRxyE0QQCFC9MwOJWBu3TFXXu/r16zkS2+12iMJ2uwV/o+EQtm1jPp/Lmvd3u23kHf5i6/UaDN/fwN98YL32Zf99ucRiscBqtTrwfGwCnr9BcH9JPBaNFbozPPbfkG+OkGsMYLlDGQsdD8XeDCU6exrM8UC8Yu/Ac/rC4Tnv7THDarNFTGuMYbSnSBQdnOeecZGv4Nx6hlqjSy9vyHVeYRGM9qusrx9d/DaeiFtG4sFBtjVFpjlBtulhyYK6O4HR8mB2ZgeBGazuG5RqF/G7KhL3dSRLLuKFGq7ubZgkbDHvwGUhBmuIYIYEc+TQZFGCQa+xq6w7xg0JKZUONLuH1HMbavWFxGYhVyB3p6IhIadpweGkSZjBcw7r3KogTu4kPErBFYV3QY55rdWHFKYnfA6X55kg5D9PLaTJQf6Qq1zbg0aulHITKo03jw40cqbXB9BqPeh2X9wIV/ivnx3+OE3iV6Yo4Z2kH3BJyf55k8VJKodT1cKpYiFNYiblTKFCnej3UrgzKiDPk6VmWBhxmCSHOr9MUKkQeq2LFLlTyrRPzrP1Pqz2Pl9pZ0DV70pO2Wkw8lno0KBKsRC3AVf1qmDLnMcsvcqhsaBBLuL5Ks6MEvFqMl6S0wvKb6YxkuKEbcMLyYVgGoJbgauapzYyD7kKz1ufeWbQNoozlviDKh+DH0tQxS/JbaraCysbBamyHwpGET0RjBfqVIQqbivd7wnygu2z7ShwyPxncMhfcT6FvBf0/kP+yNO3BNXGR6cfgx/i/uI+OzPL0Bv71GTcSQT36E+5rY+gkaj6D8ayf1sb4LrcgUq5DvbVCD5zJYf2eIHGZAHnCzS8d7jT5Zfnx/C3O/wFqstgZoBy6xwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"TCP segment structure\"\n        title=\"\"\n        src=\"/notes/static/215d6b5291f029888f756bfc9b0c2851/fb8a0/lec3-tcp-segment-struct.png\"\n        srcset=\"/notes/static/215d6b5291f029888f756bfc9b0c2851/1a291/lec3-tcp-segment-struct.png 148w,\n/notes/static/215d6b5291f029888f756bfc9b0c2851/2bc4a/lec3-tcp-segment-struct.png 295w,\n/notes/static/215d6b5291f029888f756bfc9b0c2851/fb8a0/lec3-tcp-segment-struct.png 590w,\n/notes/static/215d6b5291f029888f756bfc9b0c2851/b91be/lec3-tcp-segment-struct.png 832w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p><strong>Sequence numbers</strong></p>\n<p><strong>Sequence number for a segment</strong> is the byte stream \"number\" of first byte in segment's data.</p>\n<p><strong>Acknowledgements</strong></p>\n<p>Sequence number of next byte, expected from other size. TCP provides cumulative <code class=\"language-text\">ack</code>.</p>\n<p>TCP doesn't deal with out-of-order segments.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/2154dbd1e2b9bf7e4347ce714d7ab4fb/f18e1/lec3-tcp-ack.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 133.22784810126583%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAABYlAAAWJQFJUiTwAAADBUlEQVRIx41Va08aQRTlH/aL9t/0S+lfaNLEr6Z+1aaKUqtpkRALYtQo4LIgoLI8BZZ9zL5O78wyCrI8bjKZwAyHe885905sOByi1dJgmjp6vS5c1wWPIAiwKORZv99HvV6DpjVRq9XAGENM0zTs7v7E9vd9pM6ysG1rbcCnpyccJH4hm7vE7e0dLMtCjB8UCk+IxxM4zyniouf5KwHD4wBfv/3B1lYag+FYnMVM08TfdAb7iRSaWkt86S8BewMM7xwmszg9vYNarYWAhUIBn+NxfNjcQL3RCAH91RnyOzySJ6f4FP+Cg8MERqMRYvywolZwdHQEXR/PcPR+jwLc3tnBxuZH7O39wGAwCDlcVtayxYNTxtWWEQtFcEn2IR4fbbIAI7V8rBMSlFvN8zzxeQLokV0YXl5cdDoOymUdl5caDINhPNZpjYkOndaIfuTQ56FQOOQ7oCytV/BXQG5KGYxZSKdTyOfzuLm5gaIoyOWySCZ/k1cLOD9XqAoPjiMzZAI4EpAfSA2iRNF1nzjzoKomKhW+LOq0NzHnAN+TPr1HWanVYvQHxuQOogE5P4sAPC8gv7nUw5bIst6wiVNr8psFgJIPqSBjzkQ4Bw8PFqpVizznEoehG2zbnheFqzwdtu2Tyg4Jc4FMJoNisYiLi7wAnbXOAkDXdYT/2h0mSuFrMHAoW5fOPHGH+5WXFgr3RskMYLj7ZI0RmdtGu73c2Pz+e+HmMvR9jyaNgW6P8zUNtl77RQK22waaTUZZWpStibJqkZrBquZbLIrnOTOXrq9vcXycxtXVlRBEVVWkUmc0jO9wcvKPZmDmlQLGFqgs+ZFTZDh8ETvvZcMw6M3p0W6SmXUUS/2wmrJJ1a3RKetEt8sHCQF2jNWA3BrTBpfBpxHvYUUJOTcMGhLLSpYcyqjX64K/5+dn6pAKeZODzNrKspaIwntV1z3BT6djC5BSqSSA7+8V4Vn5kMnXb07lIPCFbarUp7wc3q/TvRpl7OlJFAnYaOgE4s3xxh8j+QpOv4aLjP0fQL4mnp9FQQUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"TCP ack, seq #s\"\n        title=\"\"\n        src=\"/notes/static/2154dbd1e2b9bf7e4347ce714d7ab4fb/fb8a0/lec3-tcp-ack.png\"\n        srcset=\"/notes/static/2154dbd1e2b9bf7e4347ce714d7ab4fb/1a291/lec3-tcp-ack.png 148w,\n/notes/static/2154dbd1e2b9bf7e4347ce714d7ab4fb/2bc4a/lec3-tcp-ack.png 295w,\n/notes/static/2154dbd1e2b9bf7e4347ce714d7ab4fb/fb8a0/lec3-tcp-ack.png 590w,\n/notes/static/2154dbd1e2b9bf7e4347ce714d7ab4fb/f18e1/lec3-tcp-ack.png 632w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h3>TCP round trip time, timeout</h3>\n<p>TCP uses a timeout/retransmit mechanism to recover from lost segments. The timeout should be larger than the connection's RTT.</p>\n<p><strong>Estimating the RTT</strong></p>\n<p>SampleRtt</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>E</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>a</mi><mo>)</mo><mo>∗</mo><mi>E</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mi>a</mi><mo>∗</mo><mi>S</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>R</mi><mi>T</mi><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">EstimatedRTT = (1 - a) * EstimateRTT + a * SampleRTT</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">a</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">d</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">a</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.46528em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">a</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathdefault\">a</span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">p</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>d</mi><mi>e</mi><mi>v</mi><mo>=</mo><mi mathvariant=\"normal\">∣</mi><mi>E</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>−</mo><mi>S</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>d</mi><mi>R</mi><mi>T</mi><mi>T</mi><mi mathvariant=\"normal\">∣</mi><mspace linebreak=\"newline\"></mspace><mi>D</mi><mi>e</mi><mi>v</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>=</mo><mo>(</mo><mn>1</mn><mo>−</mo><mi>b</mi><mo>)</mo><mo>∗</mo><mi>D</mi><mi>e</mi><mi>v</mi><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><msub><mi>b</mi><mrow><mi>d</mi><mi>e</mi><mi>v</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">dev = |EstimatedRTT - SampledRTT| \\\\\nDevRTT = (1 - b) * DevRTT + b_{dev}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">d</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathdefault\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">a</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">d</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathdefault\">a</span><span class=\"mord mathdefault\">m</span><span class=\"mord mathdefault\">p</span><span class=\"mord mathdefault\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">d</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord\">∣</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">b</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.76666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">d</span><span class=\"mord mathdefault mtight\">e</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">v</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>\n<h2>Connection-Oriented Transport: TCP</h2>\n<p>TCP creates reliable data transfer service on top of IP's unreliable service:</p>\n<ul>\n<li>pipelined segments</li>\n<li>cumulative acks</li>\n<li>single retransmission timer</li>\n</ul>\n<h3>TCP Sender events</h3>\n<p>Data received from app:</p>\n<ul>\n<li>create segment with sequence number</li>\n<li>sequence number is byte-stream number of first data byte in segment</li>\n<li>\n<p>start timer if not already running</p>\n<ul>\n<li>think of timer as for oldest unacked segment</li>\n<li>expiration interval <code class=\"language-text\">TimeOutInterval</code></li>\n</ul>\n</li>\n</ul>\n<p>Timeout:</p>\n<ul>\n<li><strong>retransmit segment that caused timeout</strong></li>\n<li>restart timer</li>\n</ul>\n<p>ack received:</p>\n<ul>\n<li>\n<p>if ack acknowledges previously unacked segments</p>\n<ul>\n<li>update what is known to be acked</li>\n<li>start timer if there are still unacked segments</li>\n</ul>\n</li>\n</ul>\n<h3>TCP Fast Retransmit</h3>\n<p>Time-out period often relatively long: long delay before resending lost packet. Detect lost segments via duplicate ACKs:</p>\n<ul>\n<li>sender often sends many segments back-to-back</li>\n<li>if segment is lost, there will likely be many duplicate ACKs</li>\n</ul>\n<p><strong>TCP fast retransmit</strong>: If sender receives 4 ACKs for same data (\"triple duplicate ACKs\"), resend unacked segment with smallest seq #:</p>\n<ul>\n<li>likely that unacked segment lost, so don't wait for timeout</li>\n</ul>\n<h3>Connection Management</h3>\n<p>Before exchanging data, sender/receiver establish a <strong>handshake</strong>:</p>\n<ul>\n<li>agree to establish connection (each knowing the other willing to establish connection)</li>\n<li>agree on connection parametes</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">Socket client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Socket</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hostname\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"port number\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nSocket connectionSocket <span class=\"token operator\">=</span> serverSocket<span class=\"token punctuation\">.</span><span class=\"token function\">accept</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4>3-way handshake</h4>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/4c63fa5e6ce16c5182cb412c8c47e886/ca4d0/lec3-3way-handshake.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 49.290780141843975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABqElEQVQoz31SiW7CMAzt/3/UtGkHE+ISGrACY0XjWtemUJo0adK+2dkhYNIsuXVd2y/vOUGWaaxWBbLM4NSapsHbWwJrnf+u69q/x5MQ85fXs9x+bxDHGkJUCKxtYKoGWlsYY2iAhXMOSinc3j2eAbBdXd/g/uErz3Wcd47Bt1gu1wi4UYgUZakwnU4xmTyTT+jnEmkqCTn3w7UuUVXnLE6N+9mDJEkwn8+puPpFZSrOWcpZ7HYxkuSDBieIondIabHdbkmmlXeOuZfZGUOUT7W41JCePuZijoVQWK8LzGYzDAYDdDodAtz5/1EUYbPZIHA0TJXlr8h8QkZsKJaywGg0Jh8hDEM8PY1JhtQP/9H0x7TWvi8wVGCI9rEo0O12MRwO0e/3SYYXEjqHyKQfwKeoa+d1ZNDLZVVElxca1FLCHY9YLBZotVro9Xpot9t0mhEtJiYqK7oWe9IwJk9RFPLPMC8LDbPEymvYfC+DG9mFEMjzHM5WfnNMRymJw0HREg7+NoThs5eB6/2WqV5THDDKpR7/mXO1BzsSq4JkKkl/7rapQPUe4xMsHv9qtRhfGAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"TCP 3-way handshake\"\n        title=\"\"\n        src=\"/notes/static/4c63fa5e6ce16c5182cb412c8c47e886/fb8a0/lec3-3way-handshake.png\"\n        srcset=\"/notes/static/4c63fa5e6ce16c5182cb412c8c47e886/1a291/lec3-3way-handshake.png 148w,\n/notes/static/4c63fa5e6ce16c5182cb412c8c47e886/2bc4a/lec3-3way-handshake.png 295w,\n/notes/static/4c63fa5e6ce16c5182cb412c8c47e886/fb8a0/lec3-3way-handshake.png 590w,\n/notes/static/4c63fa5e6ce16c5182cb412c8c47e886/526de/lec3-3way-handshake.png 885w,\n/notes/static/4c63fa5e6ce16c5182cb412c8c47e886/fa2eb/lec3-3way-handshake.png 1180w,\n/notes/static/4c63fa5e6ce16c5182cb412c8c47e886/ca4d0/lec3-3way-handshake.png 1692w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h4>Closing a connection</h4>\n<p>Client, server each close their side of connection: send TCP segment with FIN bit = 1. Respond to received FIN with ACK.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/4c37b88f45ec25380ae78f149d43a96e/909ad/lec3-closing-tcp.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB2ElEQVQ4y3VTXZOaQBDk/78nVfeDLi95ScqCKi+CgooCi7B8uXxoZ2a8VTSXqdqCHXZ7unsGpyxHqNxgmi7guF6v8mzbAXVj7jmb//jjo65b2DifR1TVSLlJMBzPWyNT7f2iBX7/8ZMuB/J+uTwAv31/o/zq8/wF3XlCGGZw3Q3GkQCVyghkxGto3SDLKmLQ0/eJQLkQFRxv+7mavjcoilzenfV6TRUiSvZEvUIQBFitVgR0JskDlsuA8hpxfMRuX6BppzsQP40xaJoWZalvgF3X3Ssy4GKxgOd5dKCQqlqXOJ1OxDbDdqvgB0pAmAADHg4Hym+x2+1k7zCbMAzlUNu2SNOUPm4RRTF8P5HKXKgsSzK+Ip96bDYbKcx3bNwsIYYszTLkJFfR+gbyGsZcSR4ze+SGYYBSCkmS3ACZEV9m6XOjR+q21gbLDx95rrDfx+RjToA8Io34Wte1sGQMBhTJVj/79GBJ49AN+PV7T9JTalBHfhZkSSOSoygSyZbVnIjD5tpg6dxl13U/fTtJd9m/NE0QHzKZuX9HTON4PD4DMrM4jmVkuDof+iqMmYjlJDNpWeV5Lt0WyTwO8wbY3+x/61nic04YMjKbOpfNnfsK/PW/fs3x+guYz+vH0BSX+wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Closing TCP connection\"\n        title=\"\"\n        src=\"/notes/static/4c37b88f45ec25380ae78f149d43a96e/fb8a0/lec3-closing-tcp.png\"\n        srcset=\"/notes/static/4c37b88f45ec25380ae78f149d43a96e/1a291/lec3-closing-tcp.png 148w,\n/notes/static/4c37b88f45ec25380ae78f149d43a96e/2bc4a/lec3-closing-tcp.png 295w,\n/notes/static/4c37b88f45ec25380ae78f149d43a96e/fb8a0/lec3-closing-tcp.png 590w,\n/notes/static/4c37b88f45ec25380ae78f149d43a96e/526de/lec3-closing-tcp.png 885w,\n/notes/static/4c37b88f45ec25380ae78f149d43a96e/fa2eb/lec3-closing-tcp.png 1180w,\n/notes/static/4c37b88f45ec25380ae78f149d43a96e/909ad/lec3-closing-tcp.png 1328w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<h2>TCP Congestion Control</h2>\n<p>Informally, congestion is when too many sources sending too much data too fast for <strong>network</strong> to handle. Manifestations:</p>\n<ul>\n<li>lost packets (buffer overflow at routers)</li>\n<li>long delays (queueing in router buffers)</li>\n</ul>\n<p>The solution for resolving congestion control is to ask sources to reduce their <strong>sending rate</strong>.</p>\n<p>Let say there's a sender and a receiver with <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>R</mi><mi>b</mi><mi>p</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">R bps</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\">p</span><span class=\"mord mathdefault\">s</span></span></span></span> link between them:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[] ===== []\n     R</code></pre></div>\n<p>the goal is to fluxuate around available bandwidth. every time a packet loss is occured, sending rate is decreased by 2. (e.g. was at 10, moved to 5).\nFirst part called slow start, the fluxuation part is called congestion avoidance</p>\n<p><strong>Approach</strong>: sender increases transmission rate (window size), probing for usage bandwidth, until loss occurs:</p>\n<ul>\n<li><strong>additive increase</strong>: increase <code class=\"language-text\">cwnd</code> (congestion window) by 1 MSS every RTT unltil loss detected</li>\n<li><strong>multiplicative decrease</strong>: cut <code class=\"language-text\">cwnd</code> in half after loss</li>\n</ul>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>T</mi><mi>c</mi><mi>p</mi><mi>T</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo>=</mo><mfrac><mrow><mi>c</mi><mi>w</mi><mi>n</mi><mi>d</mi></mrow><mrow><mi>R</mi><mi>T</mi><mi>T</mi></mrow></mfrac><mi>b</mi><mi>y</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi mathvariant=\"normal\">/</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">TcpTput = \\frac{cwnd}{RTT} bytes/s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\">c</span><span class=\"mord mathdefault\">p</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\">p</span><span class=\"mord mathdefault\">u</span><span class=\"mord mathdefault\">t</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.05744em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathdefault\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">c</span><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathdefault\">n</span><span class=\"mord mathdefault\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord mathdefault\">b</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">e</span><span class=\"mord mathdefault\">s</span><span class=\"mord\">/</span><span class=\"mord mathdefault\">s</span></span></span></span></span>\n<p>By default <code class=\"language-text\">cwnd</code> is measured in bytes.</p>\n<h3>Detecting, reacting to loss</h3>\n<ul>\n<li>\n<p>Loss indicated by timeout</p>\n<ul>\n<li><code class=\"language-text\">cwnd</code> set to 1 MSS</li>\n<li>window then grows exponentially (as in slow start) to a threshold, then grows linearly</li>\n</ul>\n</li>\n<li>\n<p>Loss indicated by 3 duplicate ACKs</p>\n<ul>\n<li>duplicate ACKs indicate network is capable of delivering some segments</li>\n<li><code class=\"language-text\">cwnd</code> is then cut in half, window then grows linearly</li>\n</ul>\n</li>\n</ul>\n<h3>Throughput</h3>\n<p>W - max window for tcp connection - max possible throughput\nW/2 - min window for tcp connection - min possible throughput\n3/4(W) - avg window - average possible throughput\nW = R * RTT</p>\n<p>max throughput = max w/rtt = w / rtt (max throughput in any round)\nmin throughput = min w/rtt = w/2 / rtt\navg throughput = avg w/rtt = 3/4w / rtt</p>\n<h3>Fairness</h3>\n<p><strong>Fairness goal</strong>: if K TCP sessions share same bottleneck link of bandwidth R, each should have average rate <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mfrac><mi>R</mi><mi>K</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{R}{K}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.217331em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.872331em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.00773em;\">R</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>.</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/f32ef49bfca82658cd746bd17eab24a0/c1354/lec3-tcp-fairness.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 46.924829157175395%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABVUlEQVQoz4VS2U7CQBTt/z/6YHwyMdFIhMADKijBLSKIihTKlkpBlK1QUi0Ng+3MsTOkIA3Bk5zcO5O5524jzWYzjMdjTCYTGMYIhRcVmXwZDC44KKOez4R1KQWlC8uwAmNMkENCAIdHUdxkH9Gdf2Lu/GArqEeXrQlLvrrPUlmGPtRBGMG73UR90EY608Be5Bg7sRBSlRSuave4zmg4CJ/htV7B4GuIb2ItKvRL9TMsk3sdG4aDYlVH9KKB/eQtdiNpxLN3iOceEL1UEE4+IZ0vIVd9Q2s4Wgly8tlwdLsmykrPswSW5eKj00FNqaJZa2I+tbdOQLQcvAydxHB6nl2eLctCUS5CLsmY2rYXxJfiiiX5XFuKaZpQVRX9fh/tVhuJZAKFwjMcxxEPNE2Doijija7ra1sNUgjyQNvLzCvh4oQQ8K/kC25qaxuk/2ayqYq/fhC/vuKukTf85r0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"TCP Fairness\"\n        title=\"\"\n        src=\"/notes/static/f32ef49bfca82658cd746bd17eab24a0/fb8a0/lec3-tcp-fairness.png\"\n        srcset=\"/notes/static/f32ef49bfca82658cd746bd17eab24a0/1a291/lec3-tcp-fairness.png 148w,\n/notes/static/f32ef49bfca82658cd746bd17eab24a0/2bc4a/lec3-tcp-fairness.png 295w,\n/notes/static/f32ef49bfca82658cd746bd17eab24a0/fb8a0/lec3-tcp-fairness.png 590w,\n/notes/static/f32ef49bfca82658cd746bd17eab24a0/c1354/lec3-tcp-fairness.png 878w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n  </span>\n  </a></p>\n<p>We focus on AIMD part of the TCP congestion control.</p>\n<p>With UDP there is no notion of congestion control. If TCP and UDP are used together, UDP will make use of entire bandwidth.</p>","frontmatter":{"date":"January 28, 2019","title":"Transport Layer","tags":["cpsc441"]}}},"pageContext":{"prev":{"fields":{"slug":"/cpsc457/lec3-interrupts-traps-kernels-vms"},"frontmatter":{"published":true,"tags":["cpsc457"]}},"slug":"/cpsc441/lec3-transport-layer","next":{"fields":{"slug":"/cpsc329/lec3-token-based-auth"},"frontmatter":{"published":true,"tags":["cpsc329"]}},"category":"cpsc441"}}